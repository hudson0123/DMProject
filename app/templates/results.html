<!-- app/templates/results.html -->
{% extends "base.html" %}

{% block title %}Results - Music Genre Classification{% endblock %}

{% block content %}
<div class="results-container">
    <h1>Analysis Results</h1>

    <!-- Model Information -->
    <section class="result-section">
        <h2>Model Configuration</h2>
        <div class="info-box">
            <p><strong>Model:</strong> {{ model_name }}</p>
            <p><strong>Processing Method:</strong> {{ processing_method }}</p>
            <p><strong>Hyperparameter Optimization:</strong> {{ 'Enabled' if use_hyperopt else 'Disabled' }}</p>
        </div>
    </section>

    <!-- Performance Metrics -->
    <section class="result-section">
        <h2>Model Performance</h2>
        <div class="metrics-grid">
            <div class="metric-box">
                <h3>Accuracy</h3>
                <p class="metric-value">{{ "%.3f"|format(evaluation.accuracy) }}</p>
            </div>
            <div class="metric-box">
                <h3>Weighted Precision</h3>
                <p class="metric-value">{{ "%.3f"|format(evaluation.precision_weighted) }}</p>
            </div>
            <div class="metric-box">
                <h3>Weighted Recall</h3>
                <p class="metric-value">{{ "%.3f"|format(evaluation.recall_weighted) }}</p>
            </div>
            <div class="metric-box">
                <h3>Weighted F1</h3>
                <p class="metric-value">{{ "%.3f"|format(evaluation.f1_weighted) }}</p>
            </div>
        </div>
    </section>

    <!-- Visualizations -->
    <section class="result-section">
        <h2>Visualizations</h2>
        <div class="visualization-grid">
            {% if visualizations.confusion_matrix %}
            <div class="visualization-box">
                <h3>Confusion Matrix</h3>
                <img src="data:image/png;base64,{{ visualizations.confusion_matrix }}" 
                     alt="Confusion Matrix">
            </div>
            {% endif %}

            {% if visualizations.feature_importance %}
            <div class="visualization-box">
                <h3>Feature Importance</h3>
                <img src="data:image/png;base64,{{ visualizations.feature_importance }}"
                     alt="Feature Importance">
            </div>
            {% endif %}

            <div class="visualization-box">
                <h3>Genre Distribution</h3>
                <img src="data:image/png;base64,{{ visualizations.genre_distribution }}"
                     alt="Genre Distribution">
            </div>

            <div class="visualization-box full-width">
                <h3>Feature Correlations</h3>
                <img src="data:image/png;base64,{{ visualizations.correlation_matrix }}"
                     alt="Feature Correlations">
            </div>
        </div>
    </section>

    <!-- Dataset Statistics -->
    <section class="result-section">
        <h2>Dataset Information</h2>
        <div class="stats-grid">
            <div class="stats-box">
                <h3>Basic Statistics</h3>
                <ul>
                    <li><strong>Total Samples:</strong> {{ data_stats.total_samples }}</li>
                    <li><strong>Features:</strong> {{ data_stats.num_features }}</li>
                    <li><strong>Genres:</strong> {{ data_stats.genres }}</li>
                </ul>
            </div>

            <div class="stats-box">
                <h3>Data Quality</h3>
                <ul>
                    <li><strong>Missing Values:</strong> {{ data_quality.missing_values|length }}</li>
                    <li><strong>Duplicates:</strong> {{ data_quality.duplicates }}</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Back Button -->
    <div class="action-buttons">
        <a href="{{ url_for('home.home') }}" class="button">Back to Settings</a>
    </div>
</div>
{% endblock %}